<section class="mat-typography">
    <mat-card id="chat-card">
        <mat-card-header>
            <mat-card-title><h1>ЧАТ</h1></mat-card-title>
        </mat-card-header>
        <mat-card-content>
            
            <mat-grid-list cols="4" rowHeight="140">
                <mat-grid-tile rowspan="4" style="padding: 0.5em;">
                    <mat-card style="height: 70vh; margin: 0.5em; padding: 0.5em; margin-bottom: 1.7em;">
                        <mat-card-header>
                            КЛИЕНТЫ 

                        </mat-card-header>
                        <mat-card-content style="height: 100%; overflow-y: scroll;">
                            <chat-client-queue id="op-chat-queue" style="width: 100%; min-width: 100%" ($clientOpen)="$startClientChat($event)">
                        </chat-client-queue>
                        </mat-card-content>
                    </mat-card>
                </mat-grid-tile>
                <mat-grid-tile colspan="3" rowspan="3">
                        <mat-card style="height: 90%; padding: 1em; width: calc(100% - 20px); margin-left:0.5em; margin-right: 0.5em;">
                            <mat-tab-group>
                                <mat-tab *ngFor="let d of $discussions" [label]="d.userid">
                                    <ng-template mat-tab-label>
                                        <span>{{d.clientID}}</span>
                                    </ng-template>
                                    <ul id="chat-lines">
                                            <li *ngFor="let ci of d.$history" class="chat-item" [ngClass]="{'chat-item-client':ci.opId}">
                                                <span *ngIf="!ci.opId" class="chat-avatar-client"></span>
                                                <div>
                                                    <p class="chat-client-text"
                                                    [ngClass]="{'chat-color-op':ci.opId, 'chat-color-client':!ci.opId}">
                        
                                                        {{ci.text}}</p>
                                                    <span class="chat-client-at">{{ci.at}}</span>
                                                </div> 
                                                <span *ngIf="ci.opId" class="chat-avatar-op"></span>
                                            </li>
                                    </ul>
                                </mat-tab>                                
                            </mat-tab-group>    
                        </mat-card>
                </mat-grid-tile>
                <mat-grid-tile colspan="3" rowspan="1">
                        <mat-card style="width:100%; margin: 0.5em;">
                            <mat-form-field style="width:80%; margin-right:1em;"> 
                                    <textarea id="text-area" matInput [(ngModel)]="$text" placeholder="Введите сообщение.."></textarea>
                            </mat-form-field>
                            <button mat-raised-button color="accent" (click)='$onSendClick(null)'>Отправить</button>
                    </mat-card>
                </mat-grid-tile>
            </mat-grid-list>
        </mat-card-content>
    </mat-card>
</section>